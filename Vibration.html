<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Vibration</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.bundle.min.js"></script>

    <style>
        p {
            display: inline;
        }
    </style>
    <div id="top">
        <div id="actionbar">

            <!-- changed the name of actionbar -->
            <a href="ConditionMonitoring.html"> <img src="arrow.png" alt="pfeil"
                    style="width:50px;height:30px;vertical-align :middle; "></a>
            <p>Home / Condition Monotoring / Vibration</p>

        </div>
    </div>
    <!-- the drop down menu -->
    </div>

    <div class="menu">
        <button class="dropDown">Historie</button>
        <div class="Content">
            <a href="history.html">Temperatur</a>
            <a href="Akustik.html">Akustik</a>
            <a href="#">Vibration</a>
        </div>
    </div>

    <div class="chart-container" style="position: relative; height:40vh; width:80vw">
        <canvas id="canvas"></canvas>
    </div>
</head>
<body>
    <script>
        // variable, which saves link to the website
        //const url = 'http://it2wi1.if-lab.de/rest/mpr_fall1';
        //const url = 'http://it2wi1.if-lab.de/rest/mpr_fall2';
        const url = 'http://it2wi1.if-lab.de/rest/mpr_fall3';
        //const url = 'http://it2wi1.if-lab.de/rest/mpr_fall4';

        async function getDaten3() {
            const response = await fetch(url);
            var auf2 = await response.json();

            // Create an array of Datum
            var labels = auf2.map(function (e) {
                return e.datum;
            });

            var vibration = auf2.map(function (e) {
                return e.werte.Tavg_vibr;
            });

            // vibration tolerance of limit - NEW
            var vibr_tolerance = auf2.map(function(e){
                return 0.15;
            });

            // vibration damage limit - NEW
            var vibr_damage = auf2.map(function (e){
                return 0.4;
            });

            let newVals3 = vibration.map(dots => dots.toString().replace(',', '.'))
            var chartObject = document.getElementById('canvas');
            var chart3 = new Chart(chartObject, {
                type: 'bar',
                data: {
                    labels: labels,  // Date Array 
                    datasets: [{
                        label: "Vibration",
                        backgroundColor: 'rgba(65,105,225,0.4)',
                        borderColor: 'rgba(65,105,255,1)',
                        data: newVals3  // Vibration Array
                    },{
                        label: "Toleranzgrenze: 0,15 m/s²",
                        backgroundColor: 'rgb(50,205,50)', // LimeGreen
                        borderColor: 'rgb(34,139,34)', // ForestGreen
                        type: 'line',
                        data: vibr_tolerance,
                        fill: false,
                        pointRadius: 0, // this value disable the point drawing
                        borderWidth: 3,
                    },{
                        label: "Schadensgrenze: 0,4 m/s²",
                        backgroundColor: 'rgba(238,64,0)',   // OrgangeRed2
                        borderColor: 'rgba(178,34,34)',   // firebrick
                        type: 'line',
                        data: vibr_damage,
                        fill: false,
                        pointRadius: 0,
                        borderWidth: 3,
                    }]
                },
                options: {
                    title: {
                        display: true,
                        text: 'Mechanische Schwingung der Welle',
              
                    },
                    scales: {
                        yAxes: [{
                            scaleLabel: {
                                //ticks: {beginAtZero: true},
                                display: true,
                                labelString: 'Vibration in m/s²'
                            }
                        }]
                    }
                }
            }
            );
        }
        getDaten3();
    </script>
</body>

</html>